import java.util.ArrayList;
import java.util.Arrays;
import java.util.Comparator;
import java.util.List;

import static java.lang.String.format;

public class ShortEncodingOfWords {

    private static final Solution SOLUTION = new Solution();

    public static void main(String[] args) {
        test(new String[]{"qaa","a","aa"}, 4);
        test(new String[]{"time", "meme", "bell"}, 15);
        test(new String[]{"time", "me", "bell"}, 10);
        test(new String[]{"t"}, 2);
        test(new String[]{"time","ti"}, 8);
        long start = System.currentTimeMillis();
        test(new String[]{"txagst", "lsrod", "zszfqwu", "obcjb", "ivujt", "lonfle", "oancm", "aqmtdj", "topva", "fhoflj", "rwfup", "wpanhc", "pzdwway", "zphapz", "fiefnz", "yhfjth", "jixhecy", "bbhozc", "xtlito", "mujqpok", "fcpql", "qoqrn", "karvpvx", "aozgyol", "ofdxcxn", "uilyg", "jbbaf", "nxtrrl", "jzstd", "gouzpz", "nmvwj", "kycjur", "wgfwnvl", "qrfvdqa", "uxrpv", "ituxds", "nkchgj", "xekfwcz", "oqgtuq", "mwvxu", "lcfcad", "pnjbkl", "jxtiwd", "jusiop", "mnhioh", "ydcth", "nnbyne", "plbgr", "ryzdg", "gktpkgs", "ifzyva", "ooncphj", "ojzuim", "syrck", "eygvtk", "rkyev", "dyciaiq", "zekku", "cyjpnae", "jecirtl", "kjuwh", "nbgswvj", "dtzjmg", "pfpttqr", "bkjlcss", "ygpbjkx", "lgkby", "vwlsf", "tpipo", "jhkzeq", "oqqwi", "hxgmrk", "zusov", "ufvpun", "woodcv", "fjuvgu", "yuwyl", "wtbngx", "ckeel", "pfqlhn", "ynrci", "isjtpwq", "xsnrlht", "cndal", "pjvzgc", "ysmpfz", "palnktq", "hiknk", "zepaqkd", "nesxsq", "kjxmf", "kluzr", "qsfgmh", "ogfjoz", "bdbze", "nfksj", "nljvyjf", "sxyfaqa", "egoia", "qarstn", "zrqyes", "fkunhof", "badami", "ewjyk", "lyalrto", "rxdbo", "nobxlo", "jzoss", "egqre", "mivtlw", "qqeqwk", "zhfuq", "cnsft", "scmol", "qbcurd", "exsgu", "axwlzlw", "imkop", "xrxism", "hisie", "igtet", "nevtb", "siirvi", "xvhhjy", "uwrifd", "qfktcrp", "qpurok", "muqbgq", "mifbmbo", "gjqetwm", "huvqde", "qfseudv", "zxrpc", "nuchw", "fhdlhg", "hclqfve", "albstn", "dffthn", "ejgvksk", "dbiav", "fsyzsox", "dfrbqw", "ioqeghc", "frvao", "tmrkyzi", "jmrfopj", "hxlkbkj", "bdzkmu", "sseqrqn", "rpehcu", "nbsce", "ymcyyf", "earilw", "gfwbltc", "xorxzcl", "parilu", "dzqrr", "zwmcl", "cxqivtm", "baaimt", "pmbrov", "mhfmn", "xkpeep", "fzzpvun", "qokds", "gaajw", "sbjvt", "xwrub", "hozzvzh", "fgwyour", "upjzx", "qjyvukf", "vfgotdy", "sauen", "cldie", "tqeqaw", "oqqoa", "tpiddf", "exvff", "dahskh", "cwjhnwo", "rhoacdy", "diobxwi", "kurdze", "ruffx", "ydlrbys", "xobhi", "jocmb", "krwefua", "mxatlgz", "xolhv", "qzrvyjc", "kjqgpkz", "ckkgw", "eqsrdrk", "vormoy", "ivyeotj", "hcttct", "mouat", "gnaoel", "natslaf", "ppkjyo", "eeptnk", "imkoiv", "xxhwam", "wxlzph", "athao", "ahdhvjf", "fmzulf", "ypqjnhr", "ppnsj", "jsdnvn", "akdvipi", "didxio", "wnmwsmf", "wfpve", "jrgwgun", "cdkus", "dxqzwyo", "lbpfqj", "fzgij", "swjpd", "kfisgc", "avubb", "etwyr", "jgkdwam", "avnuv", "yixfhm", "jajmjvr", "zitydf", "vzehcdv", "rfiwbqm", "gpdems", "xdxsw", "blrnd", "exfqtki", "gacgn", "ngbrm", "dlbdx", "yxjfgn", "titwqgd", "ssjso", "mvshlv", "refyh", "ufeejd", "xoskkny", "zpason", "eguynq", "vekbk", "nsbrosx", "fjxtmln", "jooknrd", "tgespz", "ohegjwx", "xdbccr", "jtzaca", "sqogf", "gywptx", "uzumb", "abueef", "cqeqvim", "zighi", "ygouw", "fdsyiy", "ohzjne", "embsh", "iegbs", "hrmewv", "qnftt", "rfssc", "ocemf", "vvqpwmj", "nihmwu", "tenet", "rrgyvnj", "nqjen", "wrexp", "xlxpech", "wqeld", "slvzhuz", "qsbvss", "brpno", "lbiyqa", "ymlkp", "tziwacz", "hgrnw", "qkvyv", "gfslfsx", "nwbvex", "qtsztq", "cgciqr", "yngjfvx", "grxgu", "orwufzk", "bxobh", "zkvdj", "bhgxbis", "dkpdz", "grkbdm", "eddet", "dxsgzp", "kmksmu", "nnfdbff", "qbudn", "xfcno", "fyhozz", "sukclis", "elpuhu", "cvycuw", "abvezty", "djjnnw", "unspjue", "aarfcnb", "cvdorfw", "uocyn", "omelag", "zssxtk", "pmwge", "frppn", "xrxmt", "sqwhye", "aynzwp", "ijxeed", "udqghc", "rlkdq", "japer", "srlurhf", "xxzaaft", "tmqgu", "nqykvr", "cgbdo", "fzmzwi", "xunmv", "icchlp", "pyjgr", "pvpxqau", "qgftlr", "xrrkz", "pugboek", "jcfrhcm", "lpjux", "mavjzjq", "uriep", "reyafqo", "wofaq", "urdeg", "picpch", "oxlzfi", "qvxmgd", "zyaaybs", "vdaaf", "oppnmh", "lsshaf", "lgpjppt", "noctzin", "wrrjz", "zifmgc", "pezncle", "ytgnv", "qmrap", "dydfm", "xgrphe", "niprl", "jglqh", "jymtwm", "rrcghf", "mfkcwm", "vmqlcze", "puevc", "qrayh", "xrqie", "tspgha", "vuypiir", "ajclqi", "veabzzo", "utziqs", "lljuo", "laijlfj", "zkzlc", "byrek", "eakddfn", "wlzbg", "bfeoaph", "djwyqwn", "wflfjqd", "mwqzxxo", "ppgbz", "bdxkvru", "ticytbz", "tveozel", "dwqjxyq", "liujnxh", "oleqq", "qfwynew", "hjkmqo", "kauqqf", "pmitr", "utghn", "ndzajya", "czpqib", "rrvxwrj", "poxnhz", "fbyizms", "bpsnpt", "lwmga", "zyctg", "prcro", "ofqib", "xfpnj", "zqihq", "trplsyi", "nzgyqxa", "lkfzdiu", "zzpazp", "odcnaba", "ovtoftq", "xyzfjz", "kkngjsa", "qrjkje", "sroww", "pzpmiou", "etqln", "azirqgi", "zbwatc", "cwajrl", "iqnmbb", "ueyepf", "mbobl", "yldcjxn", "bemoihi", "vgnuy", "hoxepzb", "vwjrq", "sobyc", "kdmjpao", "lsofa", "orwwu", "lbzqb", "gzjwjz", "ftlgwpg", "pjhyn", "ushla", "wlgfrp", "ozgpi", "wnvms", "fhxukgu", "stthij", "fgxxlj", "qjztfsl", "uuntfoq", "zzdifdc", "hgqcs", "bgteu", "wsivovf", "xnqase", "xkahfln", "mylwfef", "miqps", "oqhpqi", "vvybdz", "ngstwhp", "qaewjvu", "ivsvq", "lnbpvem", "qfetizx", "ffkih", "qbyttw", "vqoul", "phqoj", "svfsph", "ewskmw", "juoit", "onbgbya", "cfcrxlg", "tcybawr", "benoq", "edstjq", "wdrchit", "wgipc", "ycsamy", "pubyp", "emcfw", "qrxofry", "jzgyg", "smexum", "gbqyka", "xttok", "wgtwnpr", "kbwms", "zgcfapf", "oiqubq", "wpcgoif", "pqocfml", "uycqj", "nsvkoip", "djvhdsy", "flrddu", "lisvtr", "zrujh", "txdhkt", "vdfpao", "rhhcwjb", "lwnpzv", "dkpmntg", "jggvgq", "vuygprs", "efuxn", "frxgxew", "xntns", "saiply", "xlmec", "htkmyn", "yqlgwl", "lnslmy", "jsxfnrq", "aaaqgqt", "wkdnt", "clakdr", "bzexy", "fzxcb", "iqksycx", "vyivzdp", "lbqkccs", "camusb", "fkxxgxy", "dnpvfua", "aiqsan", "vkscv", "yzjodbf", "dzznl", "hnsxf", "wocvba", "ihgdd", "gpavbj", "skohtnq", "ffuyp", "vfvxls", "rfljmtt", "xvqlqya", "ddkoarq", "mtife", "gepdbl", "cvuothy", "gubzp", "atkeii", "ruigulb", "qkpboso", "vdbwlg", "hswkd", "pcyzein", "avxym", "qmbyp", "vowzp", "srejy", "orense", "zlpgak", "hktal", "zfwffg", "mkngd", "vnwdedj", "iknes", "bmefe", "vzzvlfu", "dzznpte", "xnhqatg", "hsaebzc", "iwnjet", "gvtzel", "sijkxgk", "wggups", "isibhm", "txlpx", "fmuldem", "vyfmlcf", "pwjgu", "wditfrx", "mdiczg", "mvrrvt", "inwjw", "sedngnx", "rgopnk", "ssgnx", "piyleca", "owkvd", "fxjnz", "wizpft", "pjjhbsh", "iiziq", "cmslfa", "qyduhm", "euydy", "vicjhva", "bjdkwy", "rhmop", "arlwnvf", "isxac", "lxegoi", "qobantn", "evbsufl", "ipzippx", "uulbu", "pshvm", "dywfqr", "wudrb", "qkarevj", "bwwdqvr", "mcabae", "xckjw", "ydkzwsd", "jchepl", "znsyid", "uoagl", "urxnhfn", "kxrtwgo", "usqivr", "tyspmx", "stssaam", "gllgi", "ulock", "yvhomlc", "nbjgl", "udwwcij", "qmvxl", "nergs", "dmjhlr", "gcewado", "puyir", "yanhc", "lywxwdt", "wuxpa", "vpywi", "vwjgt", "kihtdkg", "dllupbf", "pgbze", "shpskaq", "camdxx", "idgjeyg", "tvoxbb", "atdnosx", "wkddno", "ireeit", "qtowdz", "nlhyahf", "okjor", "aujbbsp", "xjuzf", "svkoh", "fdrjox", "nfyrwk", "ccqwswc", "vyfrrki", "snfaru", "uprol", "ztnozbb", "qdmusrz", "tihweun", "piuzf", "mvnhus", "cwmxg", "wwyfiid", "zadejb", "bkiny", "xbtxafy", "fhgnlke", "ubefs", "vekbhnn", "yuzfa", "ikyoxck", "oycff", "cjfgk", "sctmk", "ktpoxn", "jjneixm", "ygcxmi", "tgjtk", "zitmf", "zkeov", "zykvv", "setcp", "mrruzp", "ezbha", "qksnfv", "kbmake", "qnjkb", "evwsdi", "xftvym", "lyecetl", "gbgzv", "gqolnnc", "cbfio", "bfjzcem", "hutcjmi", "dwxsr", "xyzmxns", "lcphlmp", "zqbtjf", "fcmzdzx", "ldbrxi", "vrbwn", "iagwovk", "vkvfe", "aqbmx", "ksnxbo", "iuremmd", "doijdlf", "vwsko", "atoll", "gvzxz", "maqqs", "tnwhbbu", "ldhwmh", "pndqh", "czxol", "qgornf", "deaotg", "sxullvn", "bygkehn", "xuxclp", "bpyjyct", "lkndx", "bghgp", "pjlpr", "dhowg", "dvzplbp", "lyphrko", "uxmsyd", "mzbjyth", "pjiylsn", "uiilhy", "uchlwt", "ssimkfr", "nodnq", "fwkhys", "ywbklvz", "czhtog", "gntmlh", "buvob", "uyqbk", "mkazxas", "ezjevho", "jnsvvz", "pbhug", "icupwj", "gnurjx", "kolpaq", "dtrwfb", "atlaeok", "axkrd", "mbycby", "jkgabvv", "yjpzmpt", "foqwzg", "ruwpami", "hxbsi", "afijf", "dgplxn", "qjpaqiz", "mjxyc", "zepmfga", "cdyfwi", "zyresn", "hyvbdxg", "xnksdzx", "ipulltp", "zjwxs", "rwuurgb", "bvhwioa", "swkqbt", "srlxi", "qddvl", "tmyumr", "jkzcdnh", "qrynfs", "xrloon", "obghcjl", "erdkj", "uaeqnp", "wefltdo", "ubrtp", "eleka", "aejfcl", "nvdodva", "mpvtgkd", "ueueixa", "evbmglm", "aozxv", "kvtfbyp", "mjqhar", "lpwla", "vsjjhy", "vjsxo", "qejjpd", "mxudt", "avkqwr", "cxhrc", "ehxjwsq", "ogciuf", "wvvpk", "nusshh", "prtbg", "dctetwi", "xkpkq", "aivwork", "flbyjmy", "ynfyfm", "jyxupuv", "dbgpx", "hsgex", "nklqt", "lckyp", "yaqng", "bkonmw", "duwxpe", "xilbl", "igpsh", "gkwgb", "gmanwth", "ghigtz", "kbvfrss", "gnglos", "dqlawc", "egpzql", "lxkgly", "ryumr", "zmsll", "oaxqomf", "eiazvm", "ssomp", "ucmsr", "kdpkqaa", "xxhgmam", "zjxsrkb", "ivwung", "pjsthbz", "gytlb", "qtxmucm", "kqccp", "nfakyf", "ubsyh", "dxkypq", "iimdnf", "zgtrkz", "vrpwmnm", "ijrtnrr", "jpiljxh", "fykmc", "ycermv", "crziv", "uiuhtpc", "uakqds", "lxpepy", "xwvlf", "hsdyopc", "jxwci", "mxkiye", "gzmgij", "xkapl", "ujpqwv", "xntyjq", "odyklzt", "fyavujx", "ffpjgqg", "mncvzu", "rfznxsg", "vzzfmik", "thsth", "qaflji", "coytvng", "xhwww", "qjuwnay", "lzisl", "xvdaeqm", "vdgmsnk", "tjdub", "qdshm", "dkjvzm", "fquhju", "qopfoe", "wagkp", "dufjyl", "fhuxph", "paxflsx", "mcpcb", "hcaztc", "eukwmd", "mlwwcvm", "hvjau", "ylctn", "bqfyjj", "ukmmgxn", "hyvjve", "xrhgcv", "bpwle", "rlkkex", "wdntqh", "iogwix", "ckotcs", "gdmrlge", "giyjau", "dggxg", "poxdhi", "hpuhpe", "rundy", "itnger", "jujyud", "fhbixd", "yumxe", "janadf", "fylzuiq", "hwjcjug", "koubas", "bnahjb", "bmbntft", "eucah", "obwxh", "hkhfevi", "xpdbnr", "jlgaov", "wbvjahq", "esrjxu", "bekmus", "nmttkp", "ovfjnq", "lobdzgn", "fiyct", "jxsjtg", "synxat", "rdyxe", "diuzhh", "jjzvlg", "rfswqn", "vijcezs", "tkrng", "xmongsj", "wjmnzsd", "flarf", "tddiag", "pfbzc", "ifdijz", "qvzay", "nftxiz", "tbcmkfm", "urhmsn", "ukisrpr", "sflxva", "vqapak", "oeywsgp", "lomaed", "gfrce", "yifeoh", "pfasd", "aqypwx", "oblmw", "bwkgv", "lxmemmu", "nwmhr", "fjbnvyh", "sbszl", "vwqfhd", "fojrpr", "gfubow", "pqije", "isihzs", "jenoie", "bvtovn", "egilk", "vgckpwo", "hqxxfln", "hvspeun", "vjneozl", "pfrqix", "qceyeaw", "jycmqs", "gbkxte", "pekua", "ywdgo", "gtfglu", "wowbn", "ychfu", "fgfdpx", "sulhexx", "ihilcaq", "vupsm", "qkwgpmw", "hnsxwgd", "nkqxv", "mwugb", "fjnla", "pigpwnq", "uehofih", "vbivvew", "nlmrbpe", "ehwdood", "khxwy", "mfqhrn", "tasrhxz", "gvncpq", "dgyjnkt", "hvfyrne", "ztggbo", "iinhh", "lfhwug", "hvwmjt", "xddjli", "qzuceo", "fanpxj", "xydatme", "rzgqx", "qfgsuxy", "elgqvj", "jfirj", "lnkbd", "vtfjbd", "nhrakdm", "kjpsy", "lwmxsya", "dlmcgx", "rzywx", "hsrgevj", "vuozyjz", "vjews", "fopziop", "cipskga", "kcyvzr", "twxwh", "gvwaaeh", "vcjefg", "mtlpg", "bxfmnq", "qbtxwav", "vmwjw", "memgzu", "hylqiez", "tkblg", "pqqnd", "mtynw", "ysgzhwa", "haori", "alatw", "sndse", "tqptxo", "mbskixn", "crmekaa", "xsjwd", "ulqydp", "ypxzro", "gxwhj", "fqojb", "diwdwad", "awkbjuv", "qehhie", "sowbjaz", "dtbkwhw", "ysumfq", "vfgjk", "yedlr", "vovdu", "undic", "nvdsj", "zlcsoow", "cqmvl", "pknrmnx", "pulioje", "ubppxou", "xsjge", "tisxw", "yvckto", "axzolkf", "kxmltnu", "qnayq", "zepvgcb", "oyqoo", "dbqekiq", "wccfbs", "zkzohpb", "qkeqvp", "vxdsbn", "xekckq", "chiop", "cpfhfn", "iuzuki", "rczpwcm", "iahngk", "yhjxv", "srambhs", "kmfmp", "umqks", "tqwilyb", "yremtx", "gurko", "lwahue", "wdufju", "tzqgs", "fouot", "rmcct", "lifqavt", "nymwvf", "wxaij", "zarqz", "azdxu", "pjjah", "vldbhxo", "qqxgwd", "tgzfqa", "ljuna", "bzajyd", "bggnla", "ltnrqu", "bvttjhm", "jbrgvq", "twdyk", "sqnkf", "ceisdwm", "kwupt", "xabmk", "ydakdx", "hwlnuq", "lhwvd", "qsady", "gpugevk", "vojah", "vooreor", "wliwyy", "uoxsc", "qiacnt", "ikecenv", "nwjboh", "jivcr", "bnhhajb", "ryosyu", "mirxh", "whhkt", "qhqldsa", "nlruw", "rhzrz", "edduh", "wtnecg", "qrbivqr", "llksjz", "jpofz", "lnllufy", "zbevwm", "kspypc", "pxumsgm", "jzlryq", "rvafeog", "oefbb", "walrfrb", "jwijky", "lnenxm", "catpbk", "qvkwd", "hsyzsjz", "ocdbm", "uzgcgo", "twnjcx", "ekhzaxa", "kvtfpuc", "kpvuqqo", "wgdax", "irghl", "vqnvj", "sodxr", "fjszcw", "urbie", "pdzwsl", "rtneh", "opnkl", "mumsmc", "zlbemg", "fsxsrx", "wuoggz", "bocua", "bvakwub", "qugjqcg", "wspokcd", "tjycl", "uxtvaw", "nxnokp", "iudkod", "twyxnu", "tasub", "wfryaa", "dcddwjq", "awxmmew", "lohuh", "ygzrwv", "xxaok", "tzjmo", "nqlxyj", "hnoqz", "ndggp", "svixmz", "bjjlip", "cvulaup", "setbw", "fyszf", "muwux", "pbmvi", "frvhda", "zzagb", "lojwz", "nkuaf", "xmuqx", "szimrtx", "laoyw", "nsybw", "pnzcu", "uxnqq", "gdvsd", "njhaasl", "jxyynrd", "myclnjt", "bnhegvj", "tustgf", "dfoju", "jmdsbj", "qtnptsk", "mjyqt", "eqjbvn", "hvkupub", "pciyc", "dfpemkr", "trsla", "bvjkc", "xcrwfa", "hcazx", "hxezyrc", "kirmmvw", "rkknj", "ocjvcbs", "dkxzrjl", "mcxmn", "hwvpasc", "tqqhz", "zzuoig", "dukwpzc", "jbpesw", "mtnyuo", "htvsx", "jzngb", "cvvinc", "jtxja", "vstxd", "wcsaytd", "ygwyl", "uomky", "ufagoa", "inqqfcm", "dmwhv", "tojgv", "wyoeipj", "renuqtf", "nicri", "mfaxct", "nrbbpn", "wvxsuv", "smuekz", "gtmvm", "goijq", "xovbzed", "nfrvab", "vpfony", "fewtssf", "hlnezm", "jlecpq", "mplad", "tdrqm", "jcqecq", "ftswd", "dddqwm", "ucxzrfc", "ogdkvek", "kdzdhij", "lqorzyr", "czdle", "elfqf", "reuhjw", "rstzh", "dknqpxe", "suejgyg", "lsenju", "inhph", "vswuo", "ydhukn", "vfdsw", "smlvjzc", "dmrpvy", "sdpgmiq", "nzimsc", "ptjst", "ddfvo", "bszrsw", "lrdncfx", "vmurqv", "oquet", "qcqdbo", "nniwk", "pwqdn", "yqzehfu", "zmrmk", "siyfsb", "pyydy", "gbdpqw", "dfkvn", "ithdsuw", "vhaqicp", "xcjlh", "wckoxei", "qkszb", "gunhmi", "jzwinv", "lnyqj", "hxtixv", "khiysg", "sxgbc", "yxsscem", "xdcvzlc", "wuucq", "savkk", "fywzhx", "xunmev", "xbjwdop", "exnzf", "xfdoirp", "dqalgtm", "ijivkp", "qambl", "httys", "atkrzjk", "brewr", "kiugmi", "vcxmzpy", "gofkn", "asfii", "xjifn", "vkvmpm", "dywunx", "ggvoxzp", "vlcty", "rzhca", "ehkdkq", "odomko", "bhize", "jvdio", "utdvi", "bdfdi", "pahjrc", "tyglh", "oxzfzt", "klaqbi", "ejczv", "pveytks", "cdtqjq", "rndpl", "iwgove", "hxehf", "bhnzpiw", "thwjm", "zvlzde", "lnrki", "qijxs", "aytps", "owgmzo", "lphyk", "ytbdh", "zbhykc", "oefjkp", "ncfem", "sqnvsq", "fhunh", "fezow", "luzjpl", "kqdcsw", "wvstsv", "ozfsyln", "mqslsg", "egyynjy", "hdvgal", "dnsldh", "gsnwtbn", "lorvuyr", "vfjwcr", "mqqvo", "ktzefgx", "evlsekm", "pnpdhv", "cxugdvt", "cpijtts", "vzzhl", "mmurlr", "qsvexj", "yxrfnup", "efwhf", "zullz", "ieudh", "oiwta", "pdrunx", "tlosxac", "egpylkk", "tmtboc", "mouher", "eipzcqv", "uvtigh", "hgovlc", "fwxttdw", "gjxoyrz", "nebaex", "icwly", "okvfx", "adurs", "dgbcr", "bguzz", "dqstdu", "solgrk", "pgfhilf", "myxpma", "iekvomb", "pcjrdf", "ihpgqrh", "yugqvu", "psuyffn", "pfsid", "gzbbsuo", "qonhvnf", "onbkv", "hrcac", "rvzbcwd", "qtdxv", "eanjjh", "jwnhatw", "fuozsv", "wtodp", "vavzfk", "fjymf", "rchlrb", "ainmpy", "ypnfb", "kfmibxd", "juaoshv", "rhivkof", "wawyg", "zyfoou", "hvazo", "gpcwfha", "nloss", "ntcpp", "cghfzf", "ihkub", "xokof", "uvila", "ukkqz", "lvqah", "wtosg", "qfsnvb", "xwhffj", "hxmuxke", "hcllf", "fzlnay", "wsmxsq", "ziqqilg", "cmrtpm", "ywabyus", "fyreicw", "bqohfs", "lntqccy", "odlvxnx", "csxjtq", "znlat", "bliin", "slbzw", "vvfczu", "cjiumfl", "cwzskrz", "snfbyfc", "waadyr", "epztdl", "cdbtwtw", "uiggh", "dpiqjtm", "ticvlpa", "rqlnfl", "tvqym", "pvzub", "xhdwm", "ynepj", "wxstsww", "vdninky", "htwjqfk", "bokxkin", "tcvgqub", "iqprn", "ajwrnv", "euozw", "bswshrb", "xwhffz", "lxfbiwv", "huhnb", "qdafe", "jijxr", "qamco", "yhcryv", "pwfaabk", "rbeycr", "kgxqcf", "kkgzc", "wafdh", "vdhvupo", "wtugmj", "zbypkfe", "hvwnysf", "pvaqvg", "kswtkup", "cniqswh", "tksdizd", "gwulgm", "gmnns", "zlyhua", "wqkqkw", "vjpdd", "kprupe", "cnoqq", "jtmrgu", "zwxems", "ovgsxjm", "gpqxn", "qyuabr", "zdzjmv", "fqryate", "toiai", "opkgibp", "jfqjotk", "cnjbb", "bslvdr", "vaapb", "yvfiq", "glgigoy", "ckcphag", "atvhk", "jgugkn", "ogbkhwt", "awoes", "tlfsl", "hyzdfcq", "rqqnk", "vomyq", "nejrs", "ggufvpg", "lxkfn", "fnipogy", "gpeudmt", "cnlafxd", "bdiksdp", "sxdhfp", "kuoco", "dfcrobq", "uyvuatw", "eeuwzh", "hwutgdp", "ksnebl", "xxijxks", "vbzohx", "arztllb", "dbxcgjg", "wmwmgiu", "ccxix", "amfaj", "wrmrlat", "kmvxnq", "doiunev", "ygjjewk", "apnrk", "dtvgv", "jtzgw", "vghnf", "wahwev", "tafmx", "sovhktm", "bhhbncp", "mrswt", "nyohih", "tssuv", "usllsg", "ejqcub", "frxsfr", "tdrpx", "mvdmnv", "mstvxya", "gmaks", "ghinty", "efpukxb", "ifdlqyb", "yjydvy", "xeamha", "qjatbbm", "wufpeq", "qevbr", "dfqlwy", "ympme", "yvmfwr", "gmrgr", "xygikmd", "tqfda", "mbavq", "xelldza", "eegmc", "beips", "jvoyk", "kwxpx", "vkmrgc", "knyeyvu", "arbyrwd", "lntwqa", "naopw", "wsnvux", "vrcmf", "ukjja", "iyyujx", "wffpn", "oihoya", "llxni", "etzgjgl", "gzbrfn", "oejiodp", "bipld", "uzeux", "ahoktua", "cbztipq", "bsfqddw", "ravsfcu", "zvcfgyk", "cperctu", "kloumot", "vnzqnce", "stmgbyn", "xievrmm", "vxmtua", "xucywn", "eaxex", "nxdtp", "rddjh", "viyrmvd", "prethhs", "jclwj", "lkfze", "bukanv", "invlk", "bexnpay", "htnaj", "ofjoyry", "vmfxdkm", "xummkim", "yfjvj", "toqkv", "ccqwbii", "uwwqxiu", "svjkn", "hprkgmt", "vsklni", "wesukt", "bogxw", "cghsubd", "uesvlh", "ggvzsb", "mzdqi", "blyva", "cgohtu", "ajhja", "mfppfs", "olmnjrp", "kojnbo", "jcgsz", "dmjgy", "cqauhy", "shigiw", "agefu", "yzwua", "zqznf", "yhztsz", "ltiyrgb", "vxwgu", "vncvaj", "jjhnlv", "ptaulu", "qctsc", "hzclagq", "wqchgxm", "qcawjck", "pymzyt", "ovtagtu", "uyigod", "ksmoxf", "rzhdtzv", "eiylda", "tpuga", "ipcbxny", "uitceki", "nkfkabw", "hmnjecz", "rrrliyh", "fdpar", "usmtmhb", "bxnufer", "bmnltri", "pehehcp", "qefsg", "baonqvy", "scyfus", "bmnkjt", "isbski", "duukfaw", "rweaalc", "urwypph", "fewkh", "uftwnm", "ckmvn", "frnuh", "gdpzyj", "bgyrr", "sfimx", "rdbsk", "slwjd", "kkbse", "uabdo", "gzdxl", "slojss", "loqwgy", "usqmz", "jjwdiq", "ecaxx", "cvqesnu", "tewbdk", "zhfcn", "mhkqkju", "mjhrerl", "ruikubh", "bdthvz", "ydqqql", "wdidv", "pqgbx", "gxljfr", "qoxrjc", "itefeps", "harhcw", "ihrsr", "yqjaa", "lfggv", "befecml", "ouknc", "jtkds", "wdlapkz", "rneajzc", "tcthe", "hruxm", "vqrwbzh", "uppzo", "xvaptin", "ojejrd", "ltoaqll", "hmhlywc", "zuoak", "zhkwiwp", "mnnyri", "fuyzyja", "kchdflo", "ypeoar", "zfygx", "ilzmsc", "nhklo", "gbrdt", "fpnkmnz", "jdjbxhe", "jmaux", "hujir", "durgemi", "nxpgx", "ndbtgk", "wfrrf", "qzhicg", "xgnuj", "uiobmn", "opmqyaw", "hyjwupo", "fupzdz", "sobfoy", "jowjbz", "fqfik", "ivetk", "omqxc", "umavkjd", "tccwvh", "kqeejq", "ppylul", "zrgtti", "tmwrbsj", "mmsuzn", "blvvc", "vloztvc", "xkaygi", "copvgs", "kgiixik", "ividtd", "rdovw", "uwlfok", "bdephu", "bufjlkf", "uejqke", "josjhxs", "ljzcyel", "filaz", "nabpaep", "fodjd", "ondmwj", "kvwscns", "ppwkzb", "ssmga", "vtgvyqg", "vpoocfv", "evpzii", "kvjci", "ftnwzpe", "rmlmocb", "feckm", "mawxdq", "zhknj", "xyvmc", "bjhjq", "wbgboy", "oacpxrj", "bojag", "ipwsx", "uilav", "waerrr", "ivuacyp", "zxvxsl", "jordwx", "ggkyfz", "iczvgm", "lhcal", "cylzenk", "toexw", "bkvweuz", "llsmmv", "gujwpb", "imtdz", "ewkds", "jevin", "osadq", "paxrhkf", "ezita", "pnbupdk", "fimmjrk", "ylzgmx", "tcqazdo", "lenmlvd", "qwzhqws", "mydmz", "lqpjcw", "ytnks", "ewrjkav", "xpocppi", "htsggr", "twoix", "kpndqv", "mjbtxz", "hrdzv", "kmmhi", "bkqnyp", "ncvftye", "egerxdp", "fpsxu", "hwsggi", "sdmee", "gfjpab", "tnazs", "hjatsn", "bqhqbw", "zbpwri", "porvqyi", "nmzol", "qbnkmb", "ygisfbn", "ppdpta", "trygju", "vhrtemz", "golhryn", "wkpgd", "rtkbi", "whsmlbk", "umaozye", "coihqve", "oaqtevy", "hhybwbw", "niqtge", "hidzxor", "nzfaasf", "qtdzj", "jwsiai", "wlaksip", "myasuab", "gebaoi", "fmerd", "wzjmo", "ofnic", "uixhxn", "yqrfw", "iagxi", "zmfuik", "ouoeo", "lkecmaj", "jgilop", "woapx", "cruqnkx", "edvmxfn", "gzuszm", "fztbykx", "fazgfzi", "tftdxta", "ceqpz", "dtcmns", "xztnxc", "ttghyod", "mrowawj", "khecahj", "nhbpcz", "jiuwi", "uvmpc", "mruoi", "gojxx", "vdldolu", "rpiohx", "wrxav", "cimcp", "esuyfz", "twtmpt", "xopsmzo", "ksacp", "goendz", "eklce", "mcxlgyb", "dgkig", "wwexd", "hgaees", "snksnhz", "lxcdqpl", "nhlbtj", "zorxjhf", "uvhyjxd", "oijnuu", "lgyex", "gulhty", "ffsvcht", "daxcvn", "uygjck", "jrkumq", "rvlda", "apxbuwn", "ilcydo", "rxxse", "glgxrz", "qkblz", "nihfppj", "ibqohd", "lysongh", "qrossgw", "onkzgis", "ujamvr", "vllyhf", "voywxh", "lcbwz", "nqqwcxj", "guvtv", "higjf", "vcjmlec", "xvbda", "vklww", "ybtjprm", "iczhhh", "nlhjk", "tayetw", "ayxeon", "uyxss", "zegnmv", "ijzpwm", "yvdocx", "mudap", "qbqdjn", "gqrlf", "fwmymwf", "yzoqz", "bxqnn", "mobrb", "bwrmlk", "iamylwb", "irskgry", "cdcqny", "qdqbj", "lszoncs", "wwudezn"}, 13923);
        System.out.println(System.currentTimeMillis() - start);
    }

    private static void test(String[] input, int expected) {
        final var minimumLengthEncoding = SOLUTION.minimumLengthEncoding(input);
        if (minimumLengthEncoding != expected) {
            throw new IllegalStateException(format("Test failed! Input: %s Expected: %d but got %d",
                    Arrays.toString(input), expected, minimumLengthEncoding));
        }
    }
}

class Solution {

    public static final String END = "#";

    public int minimumLengthEncoding(String[] words) {
        final StringBuilder builder = new StringBuilder();
        Arrays.sort(words, Comparator.comparing(String::length, Comparator.reverseOrder()));
        List<Integer> ends = new ArrayList<>();

        builder.append(words[0]).append(END);
        ends.add(builder.length() - 1);

        for (int i = 1; i < words.length; i++) {
            String word = words[i];
            boolean isSubstring = false;
            for (Integer end : ends) {
                int b = end - word.length();
                if (b >= 0) {
                    int w = 0;
                    while (w < word.length() && builder.charAt(b) == word.charAt(w)) {
                        w++;
                        b++;
                    }
                    if (w == word.length()) {
                        isSubstring = true;
                        break;
                    }
                }
            }
            if (!isSubstring) {
                builder.append(word).append(END);
                ends.add(builder.length() - 1);
            }
        }

        return builder.length();
    }
}